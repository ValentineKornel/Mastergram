import { Link, useNavigate } from "react-router-dom";
import styles from './LoginFrom.module.css';
import { useState } from "react";
import authApi from "../../../services/authApi";

const LoginForm = () => {

    const navigate = useNavigate();
    const [username, setUsername] = useState();
    const [password, setPassword] = useState();
    const [message, setMessage] = useState();

    const onChangeUsername = (event) => {
        setUsername(event.target.value)
    }

    const onChangePassword = (event) => {
        setPassword(event.target.value);
    };

    const login = async (event) => {
        event.preventDefault();

        try {
            const response = await authApi.login(username, password);
            const data = await response.json();

            if (response.ok) {
                const token = data.token;
                localStorage.setItem('token', token);

                navigate('/');
            } else {
                setMessage(data.message);
            }
        } catch (error) {
            console.error('Error during login:', error);
        }

    }

    return(
        <form id={styles.loginForm}>
            <label id={styles.titleLabel}>Mastergram</label>
            {
                message !== null ? <label id={styles.messageLabel}>{message}</label> : null
            }
            <input onChange={onChangeUsername} type="text" placeholder="username"/>
            <input onChange={onChangePassword} type="password" placeholder="password"></input>
            <button onClick={login} id={styles.loginButton} type="submit">LOGIN</button>
            <svg style={{marginTop:'20px', marginBottom:'15px'}} width="317" height="12" viewBox="0 0 317 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M153.784 3.88714C154.179 4.24814 154.491 4.68435 154.72 5.19577C154.954 5.70719 155.07 6.29005 155.07 6.94437C155.07 7.52724 154.972 8.0819 154.777 8.60836C154.581 9.13482 154.299 9.58796 153.931 9.96776C153.543 10.3626 153.088 10.671 152.566 10.8928C152.043 11.1109 151.421 11.22 150.699 11.22C150.116 11.22 149.565 11.1241 149.046 10.9323C148.527 10.7405 148.07 10.4623 147.675 10.0975C147.284 9.74025 146.974 9.30592 146.745 8.7945C146.515 8.28309 146.4 7.71338 146.4 7.08539C146.4 6.43107 146.511 5.8388 146.733 5.30858C146.959 4.7746 147.267 4.31771 147.658 3.9379C148.046 3.56562 148.504 3.27983 149.035 3.08052C149.569 2.87746 150.136 2.77593 150.738 2.77593C151.336 2.77593 151.896 2.8737 152.419 3.06924C152.946 3.26478 153.401 3.53742 153.784 3.88714ZM152.334 9.6124C152.504 9.2702 152.626 8.88287 152.701 8.45042C152.776 8.01797 152.814 7.52912 152.814 6.98385C152.814 6.52132 152.78 6.07195 152.712 5.63574C152.648 5.19577 152.538 4.80468 152.38 4.46248C152.218 4.12028 152.004 3.84577 151.737 3.63895C151.47 3.43212 151.137 3.32871 150.738 3.32871C150.058 3.32871 149.54 3.65211 149.187 4.2989C148.833 4.94194 148.657 5.85196 148.657 7.02898C148.657 7.52912 148.694 8.00105 148.77 8.44478C148.849 8.88852 148.971 9.27584 149.136 9.60676C149.305 9.94144 149.52 10.2028 149.779 10.3908C150.039 10.5751 150.358 10.6672 150.738 10.6672C151.11 10.6672 151.43 10.5732 151.697 10.3852C151.964 10.1971 152.177 9.93956 152.334 9.6124ZM165.054 11H161.986C161.455 10.1877 161.014 9.54095 160.66 9.05962C160.31 8.57828 159.874 8.02173 159.351 7.38998H159.041V9.8211C159.041 9.95648 159.066 10.0712 159.115 10.1652C159.167 10.2592 159.265 10.3382 159.408 10.4021C159.479 10.4322 159.59 10.4641 159.741 10.498C159.895 10.5281 160.026 10.5487 160.135 10.56V11H155.866V10.56C155.975 10.5487 156.117 10.5337 156.294 10.5149C156.475 10.4923 156.603 10.466 156.678 10.4359C156.821 10.3758 156.917 10.3006 156.965 10.2103C157.014 10.1163 157.039 9.99784 157.039 9.85495V4.20865C157.039 4.07328 157.018 3.96046 156.977 3.87021C156.935 3.77996 156.836 3.70099 156.678 3.63331C156.557 3.58442 156.415 3.54306 156.249 3.50921C156.087 3.47537 155.96 3.45093 155.866 3.43588V2.99591H160.355C161.359 2.99591 162.121 3.15385 162.64 3.46973C163.163 3.78184 163.424 4.25566 163.424 4.89117C163.424 5.45148 163.262 5.90273 162.939 6.24493C162.619 6.58337 162.13 6.84848 161.472 7.04026C161.728 7.37118 162.025 7.75474 162.364 8.19095C162.706 8.62717 163.061 9.07278 163.43 9.52779C163.546 9.67445 163.704 9.85495 163.903 10.0693C164.106 10.2799 164.285 10.4096 164.439 10.4585C164.526 10.4848 164.635 10.5074 164.766 10.5262C164.902 10.545 164.998 10.5563 165.054 10.56V11ZM161.213 5.04911C161.213 4.51513 161.062 4.12592 160.762 3.8815C160.465 3.63331 160.04 3.50921 159.487 3.50921H159.041V6.85976H159.47C160.023 6.85976 160.451 6.71498 160.756 6.42543C161.061 6.13588 161.213 5.6771 161.213 5.04911Z" fill="#5A686C"/>
                <path d="M179.567 5.00195H316.505M0.494141 5.00195H137.432" stroke="#EBEBEB" stroke-width="1.05019"/>
            </svg>
            <button id={styles.loginGoogleButton}>
                <svg width="20" height="20" viewBox="0 0 22 23" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M11.2246 9.18359V13.5306H17.2655C17.0002 14.9286 16.2042 16.1123 15.0103 16.9082L18.6532 19.7348C20.7757 17.7756 22.0002 14.898 22.0002 11.4796C22.0002 10.6837 21.9288 9.91835 21.7961 9.18372L11.2246 9.18359Z" fill="#4285F4"/>
                    <path d="M4.93395 13.3613L4.11234 13.9903L1.2041 16.2556C3.05106 19.9188 6.83653 22.4495 11.2243 22.4495C14.2549 22.4495 16.7957 21.4495 18.6529 19.7352L15.01 16.9086C14.01 17.5821 12.7345 17.9903 11.2243 17.9903C8.30592 17.9903 5.82637 16.0209 4.93854 13.3678L4.93395 13.3613Z" fill="#34A853"/>
                    <path d="M1.20401 6.19385C0.438735 7.70401 0 9.40813 0 11.2244C0 13.0408 0.438735 14.7449 1.20401 16.255C1.20401 16.2652 4.93881 13.3571 4.93881 13.3571C4.71431 12.6836 4.58162 11.9693 4.58162 11.2243C4.58162 10.4793 4.71431 9.76508 4.93881 9.0916L1.20401 6.19385Z" fill="#FBBC05"/>
                    <path d="M11.2245 4.46943C12.8776 4.46943 14.347 5.04085 15.5205 6.14292L18.7348 2.92864C16.7858 1.11233 14.2552 0 11.2245 0C6.83676 0 3.05106 2.52043 1.2041 6.19395L4.93879 9.09195C5.8265 6.43883 8.30615 4.46943 11.2245 4.46943Z" fill="#EA4335"/>
                </svg>
                <span style={{marginLeft:'10px'}}>Log in with Google</span>
            </button>
            <label id={styles.recoveryLink}>Forgott password?</label>

            <svg style={{marginTop: '20px', marginBottom: '10px'}} width="71" height="2" viewBox="0 0 71 2" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M0.738281 0.966797H70.2608" stroke="#EBEBEB" stroke-width="1.05019"/>
            </svg>

            <Link id={styles.signUpLink} to='/auth/sign-up'>Don't have an account? Sign Up</Link>
        </form>
    )
}

export default LoginForm;